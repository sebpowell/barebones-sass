@mixin span($columns, $position: "", $gutter: map-get($grid, gutter), $offset: 0) {

	float: left;
	
	$length: length($columns);
	@if $gutter == false {
		margin-right: 0;
		width: 100% / $columnCount * $columns;
	}

	@if $length > 2 {

		$columnCount: nth($columns, 1);
		$columnContext: nth($columns, 3);
		$gutterCount: $columnContext - 1;

		$totalGutters: ($columnContext / $gutter) + ($columnContext - 1);
		@debug $totalGutters;
		$gutterWidth: 100% / $totalGutters;
		@debug $gutterWidth;

		$totalGutterWidth: $gutterWidth * $gutterCount;

		@debug $totalGutterWidth;
		$columnWidth: (100% - $totalGutterWidth) / $columnContext;
		// @debug $columnWidth;

		margin-right: $gutterWidth;
		width: ($columnCount * $columnWidth) + (($columnCount - 1) * $gutterWidth);
		&:last-child {
			margin-right: 0;
		}
	}

	@if $length < 2 {
		$totalGutters: (map-get($grid, columns) / $gutter) + (map-get($grid, columns) - 1);
		$gutterWidth: 100% / $totalGutters;
		$totalGutterWidth: $gutterWidth * $gutterCount;
		$columnWidth: (100% - $totalGutterWidth) / map-get($grid, columns);

		margin-right: $gutterWidth;
		width: ($columns * $columnWidth) + (($columns - 1) * $gutterWidth);
		&:last-child {
			margin-right: 0;
		}
	}


	@if $offset > 0 {
		margin-left: columnCalc($offset) + $gutterWidth;
	}

	@if $position == "last" {
		margin-right: 0;
		float: right;
	}

}

@function span($columns) {
	@return columnCalc($columns);
}

// Generate column helper classes.
@for $i from 1 through $columnCount {
	.columns-#{$i} {
		@include if-below($gridBreakpoint) {
			width: 100%;
			margin-bottom: $gutterWidth;
		}
		@include if-above($gridBreakpoint) {
			@if $i $columnCount {
				width: $i * $columnWidth + ($i - 1) * $gutterWidth;
				float: left;
				margin-right: $gutterWidth;
				&:last-child {
					margin-right: 0;
				}
			}
			@else {
				width: 100%;
			}
		}
	}
}

// Generate breakpoint-specific column helper classes.
@each $key, $value in $breakpoints {
	@for $i from 1 through $columnCount {
		.columns-#{$i}-#{$key} {
			margin-bottom: $gutterWidth;
			@include if-above($key) {
				margin-bottom: 0 !important;
				@if $i > 1 {
					width: columnCalc($i);
					float: left;
					margin-right: $gutterWidth;
					&:last-child {
						margin-right: 0;
					}
				}
			}
		}
	}
}

